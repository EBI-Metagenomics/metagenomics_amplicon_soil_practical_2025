[
  {
    "objectID": "sessions/metagenomics.html",
    "href": "sessions/metagenomics.html",
    "title": "Metagenomics practical",
    "section": "",
    "text": "Learning Objectives\n\n\n\n\nReuseApache 2.0",
    "crumbs": [
      "Home",
      "Sessions",
      "Metagenomics practical"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Metagenomics and amplicon data at MGnify (2025)",
    "section": "",
    "text": "This is the course material for the metagenomics and amplicon introductory session hosted by MGnify at the plants breeding workshop at CIHEAM.\n\nOverview\nGain knowledge of the data and tools used in the field of metagenomics and amplicon studies.\nThese sessions will cover different insights and tools used for metagenomics and amplicon data analysis workflow from the point of newly generated sequence data. Participants will explore the use of publicly available resources and tools to manage, analyse and interpret metagenomics and amplicon data. The content will include issues of data quality control and how to submit to public repositories. At the end of this session, participants will be familiary with the galaxy and MGnify platforms, they will have gained insights on how impactful the choice in reference database can be, and be able to perform a first evaluation of amplicon and metagenomics datasets.\nThe slides of reference can be found at (insert link here)"
  },
  {
    "objectID": "sessions/amplicon.html#download-an-amplicon-sample",
    "href": "sessions/amplicon.html#download-an-amplicon-sample",
    "title": "Amplicon practical",
    "section": "Download an amplicon sample",
    "text": "Download an amplicon sample\nhttps://www.ebi.ac.uk/ena/browser/view/SRR5527446 –&gt; download selected files. We will focus on a sample from oilseed rape seeds.\nWhat is galaxy\nhttps://usegalaxy.org/\nCreate an account (give students 5 minutes)\nLog-in to your account.\nIn the top-left corner, find the upload button, and submit the amplicon sample you downloaded.",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#quality-assessment-with-fastqc",
    "href": "sessions/amplicon.html#quality-assessment-with-fastqc",
    "title": "Amplicon practical",
    "section": "Quality assessment with FastQC",
    "text": "Quality assessment with FastQC\nAssessing datasets quality is an essential step if we aim to obtain a meaningful downstream analysis. We can do this by looking at the raw sequence, which is usually stored in a FASTQ file. The FASTQ format is a text-based format that contains the raw sequence returned by the sequencer, and quality values associated to every base pair.\nFastQC is tool allowing you to observe sequence quality and content quickly.\nLook up FastQC in the list of tools on the top right corner, and launch it on the sequences that you uploaded.\nFastQC returns two types of outputs: a raw file and a pre-made html file containing multiple graphs with information about the sequence. Download that file, extract it, and open it in your browser of preference. FastQC provides information on various parameters, such as the range of quality values across all bases at each position.\nThe first section of a FastQC report is a summary for all quality checkes tested by the tool.\n\n\n\nFastQC summary\n\n\nIt looks like not all the checks passed, let’s look at a few of these more in detail.\n\n\n\nFastQC base quality\n\n\nFor each position, a BoxWhisker-type plot is drawn:\n\nThe central red line is the median value.\nThe yellow box represents the inter-quartile range (25-75%).\nThe upper and lower whiskers represent the 10% and 90% points.\nThe blue line represents the mean quality.\n\nThe y-axis on the graph shows the quality scores. The higher the score, the better the base call. The background of the graph divides the y-axis into very good quality calls (green), calls of reasonable quality (orange), and calls of poor quality (red).\n\n\n\n\n\n\nQuestion\n\n\n\nLooking at the plot above, what does the quality of the sample look like?\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nThe majority of the base sequence quality values falls into the good-quality section of the graph, and only the lower side of the whiskers is sometimes falling in the red region.\n\n\n\nYou can also look up the distribution of the average quality per read in the sample:\n\n\n\nFastQC sequence quality\n\n\nYou can observe how the distribution of amplicon bases is much more scattered compared to a metagenomic samples. This is usually because amplicon sequencing targets specific regions, leading to a higher chance of the same base position containing the same base.\n\n\n\nFastQC base content\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nThe DNA composition looks very even until nucleotide ~10, and after that, there are distinct differences. Why do you think that is?\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nThe first bases in this sample are primer sequence. In amplicon libraries, all reads start at (nearly) the same position because PCR primers define the amplicon boundaries. This means that the same primer sequence (or its reverse complement) is present at the start of almost every read, leading to a highly uniform per-base sequence content. After nucleotide ~10, the biological target sequence begins.\n\n\n\nThere are a few other summaries in this report you can look into. You may notice that a few of these summaries are labelled as failed (red cross), but this is not an error for amplicon sequences, as we are mostly targeting repeated sequences, and duplication/GC content expectations differ a lot from what a metagenomic sample would yield.",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#performing-taxonomic-annotation-of-your-amplicon-data",
    "href": "sessions/amplicon.html#performing-taxonomic-annotation-of-your-amplicon-data",
    "title": "Amplicon practical",
    "section": "Performing taxonomic annotation of your amplicon data",
    "text": "Performing taxonomic annotation of your amplicon data\nIn the following section we will compare results from two different tools that we will launch on your amplicon data: Kraken2 and MAPseq. You will observe how the choice in tool and reference database can change results drastically.\n\n\n\n\n\n\nStepConvert fastq to fasta\n\n\n\nThis step is needed to proceed with downstream analyses. Fasta files are fastq files deprived of their quality values.\nLook up FASTQ to FASTA in the list of tools\n\n\n\n\n\n\n\n\nCautionBeware of pointing to the correct file\n\n\n\nAnalyses names can be a bit confusing in galaxy - to remember which files you are supposed to use in downstream anallyses it is recommended to rename them by pressing the pencil symbol on the analysis, and then editing the Name to something you’ll remember easily.\n\n\n\nMAPseq\nMAPseq provides a fast and accurate sequence read mapping against hierarchically clustered and annotated reference sequences.\nFrom the MAPseq repo:\nMAPseq is a set of fast and accurate sequence read classification tools designed \nto assign taxonomy and OTU classifications to ribosomal RNA sequences. This is \ndone by using a reference set of full-length ribosomal RNA sequences for which \nknown taxonomies are known, and for which a set of high quality OTU clusters \nhas been previously generated. For each read, the best guess and correspoding \nconfidence in the assignment is shown at each taxonomic and OTU level.\nLook up MAPseq in the list of tools, and select the SSU database, as this was the targeted subunit, and default parameters.\nWe ran the sample against LSU and ITS databases, but the yield was very low, as expected.\nAmong the available options, there is the possibility of creating a table suitable for krona plot generation. This will be used later for a visual observation of your dataset.\n\n\nKraken2\nWhile MAPseq is based on seuqence alignment against a reference, Kraken2 is a k-mer based taxonomy annotation tool. This means that every sequence is split in k-mers and searched against a database to identify which taxa matches it the most.\n\nLook up Kraken2 in the list of tools. Keep all parameters set as default set of parameters, with the exception of:\n\nEnable quick operation will make processing faster by only using the best hit.\nSelect a Kraken2 database - use SILVA from 2022 (the most recent SILVA instance on galaxy)\n\nIn a separate session you could try changing these parameters and aim for better accuracy, bearing in mind that execution time might increase.\n\nKraken-report + Krakentools\nA few more steps are required for kraken data to be converted to a format ingestable in a krona plot.\nFirst, select ‘Kraken-report’ from the list of tools, and give it the Kraken classification file as input. The tool will only run for a few seconds. Do the same with ’ Krakentools: Convert kraken report file to krona text file’ by giving it the file ‘Kraken-report’ just generated.\n\n\nKrona pie chart\nUse both tabular files that have been generated by MAPseq and Kraken2 as input files. This tool will generate a separate plot for each dataset.\n\n\n\nKraken2 vs MAPseq comparison\nOpen the two krona plots you just generated. They should look like these two:\n\n\n\n\n\n\nMAPseq\n\n\n\n\n\n\n\nKraken2\n\n\n\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nNotice the contamination on MAPseq’s output, and the difference in annotation numbers between the two (to be found in the top-right corner). Thinking about the parameters that we used, do you understand why this was picked up by MAPseq, but not by Kraken2?\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nKraken2 was only focused on a bacterial database, while we used a generic SSU database for MAPseq. Also this shows probably how much contamination there was in the initil sample, underlying how important it is to decontaminate your sample beforehand.\n\n\n\nLet’s focus only on the bacterial annotations by clicking on the Bacteria sections of the plots.\n\n\n\nMAPseq_bac",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  }
]