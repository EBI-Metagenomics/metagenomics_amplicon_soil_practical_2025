[
  {
    "objectID": "sessions/metagenomics.html",
    "href": "sessions/metagenomics.html",
    "title": "Metagenomics practical",
    "section": "",
    "text": "Learning Objectives\n\n\n\n\nReuseApache 2.0",
    "crumbs": [
      "Home",
      "Sessions",
      "Metagenomics practical"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Metagenomics and amplicon data at MGnify (2025)",
    "section": "",
    "text": "This is the course material for the metagenomics and amplicon introductory session hosted by MGnify at the plants breeding workshop at CIHEAM.\n\nOverview\nGain knowledge of the data and tools used in the field of metagenomics and amplicon studies.\nThese sessions will cover different insights and tools used for metagenomics and amplicon data analysis workflow from the point of newly generated sequence data. Participants will explore the use of publicly available resources and tools to manage, analyse and interpret metagenomics and amplicon data. The content will include issues of data quality control and how to submit to public repositories. At the end of this session, participants will be familiary with the galaxy and MGnify platforms, they will have gained insights on how impactful the choice in reference database can be, and be able to perform a first evaluation of amplicon and metagenomics datasets.\nThe slides of reference can be found at (insert link here)"
  },
  {
    "objectID": "sessions/amplicon.html#download-an-amplicon-sample",
    "href": "sessions/amplicon.html#download-an-amplicon-sample",
    "title": "Amplicon practical",
    "section": "Download an amplicon sample",
    "text": "Download an amplicon sample\nhttps://www.ebi.ac.uk/ena/browser/view/SRR5527446 –&gt; download selected files. We will focus on a sample from oilseed rape seeds.\nWhat is galaxy\nhttps://usegalaxy.org/\nCreate an account (give students 5 minutes)\nLog-in to your account.\nUpload the amplicon sample you downloaded.\n\n\n\nupload",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#fastqc",
    "href": "sessions/amplicon.html#fastqc",
    "title": "Amplicon practical",
    "section": "FastQC",
    "text": "FastQC\nLook up FastQC in the list of tools\nFastq files contain the raw sequence returned by the sequencer, including quality values associated to every base pair.\nFastQC returns two types of outputs: a raw file and a pre-made html file containing multiple graphs with information about the sequence. Download that file, extract it, and open it in your browser of preference.\n\n\n\nFastQC summary\n\n\nPer base sequence quality is quite decent for all reads in the sample.\n\n\n\nFastQC base quality\n\n\nFor each position, a BoxWhisker-type plot is drawn:\n\nThe central red line is the median value.\nThe yellow box represents the inter-quartile range (25-75%).\nThe upper and lower whiskers represent the 10% and 90% points.\nThe blue line represents the mean quality.\n\nThe y-axis on the graph shows the quality scores. The higher the score, the better the base call. The background of the graph divides the y-axis into very good quality calls (green), calls of reasonable quality (orange), and calls of poor quality (red).\nYou can also look up the distribution of the average quality per read in the sample\n\n\n\nFastQC sequence quality\n\n\nYou can observe how the distribution of amplicon bases is much more scattered compared to a metagenomic samples. This is usually because amplicon sequencing targets specific regions, leading to a higher chance to the same base position containing the same base.\n\n\n\nFastQC base content\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nThe DNA composition looks very even until nucleotide ~10, and after that, there are distinct differences. Why do you think that is?\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nThe first bases in this sample are primer sequence. In amplicon libraries, all reads start at (nearly) the same position because PCR primers define the amplicon boundaries. This means that the same primer sequence (or its reverse complement) is present at the start of almost every read, leading to a highly uniform per-base sequence content. After nucleotide ~10, the biological target sequence begins.\n\n\n\nThere are a few other summaries in this report you can look into. You may notice that a few of these summaries are labelled as failed (red cross), but this is not an error for amplicon sequences, as we are mostly targeting repeated sequences, and duplication/GC content expectations differ a lot from what a metagenomic sample would yield.",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#performing-taxonomic-annotation-of-your-amplicon-data",
    "href": "sessions/amplicon.html#performing-taxonomic-annotation-of-your-amplicon-data",
    "title": "Amplicon practical",
    "section": "Performing taxonomic annotation of your amplicon data",
    "text": "Performing taxonomic annotation of your amplicon data\nIn the following section we will compare results from two different tools that we will launch on your amplicon data: Kraken2 and MAPseq. You will observe how the choice in tool and reference database can change results drastically.\n\n\n\n\n\n\nStepConvert fastq to fasta\n\n\n\nThis step is needed to proceed with downstream analyses. Fasta files are fastq files deprived of their quality values.\nLook up FASTQ to FASTA in the list of tools\n\n\n\n\n\n\n\n\nCautionBeware of pointing to the correct file\n\n\n\nAnalyses names can be a bit confusing in galaxy - to remember which files you are suppoed to use in downstream anallyses it is recommended to rename them by pressing the pencil symbol on the analysis, and then editing the Name to something you’ll remember easily.",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#mapseq",
    "href": "sessions/amplicon.html#mapseq",
    "title": "Amplicon practical",
    "section": "MAPseq",
    "text": "MAPseq\nLook up MAPseq in the list of tools\nLet’s select the SSU database, as this was the targeted subunit, and default parameters.\nSeparately we decided to run LSU and ITS databases, but the yield was very low, as expected.\nAmong the available options, there is the possibility of creating a table suitable for krona plot generation. This will be used later for a visual observation of your dataset.",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#kraken2",
    "href": "sessions/amplicon.html#kraken2",
    "title": "Amplicon practical",
    "section": "Kraken2",
    "text": "Kraken2\nCHECK WHAT IS THE FASTEST, SILVA 138 16S or SILVA 2022\n25: 2022-02-02T162959Z_silva_kmer-len_35_minimizer-len_31_minimizer-spaces_6_load-factor_0.7\n26: 16S_SILVA138_k2db2021-08\nLook up Kraken2 in the list of tools, let’s launch it with a default set of parameters, but only allowing for the best hit to be used. In a separate session you could change these parameters and aim for better accuracy, bearing in mind that execution time might increase.\n\nKraken-report + Krakentools\nA few more steps are required for kraken data to be converted to a format ingestable in a krona plot.\nFirst, select ‘Kraken-report’ from the list of tools, and give it the Kraken classification file as input. The tool will only run for a few seconds. Do the same with ’ Krakentools: Convert kraken report file to krona text file’ by giving it the file ‘Kraken-report’ just generated.\n\n\nKrona pie chart\nUse both tabular files that have been generated by MAPseq and Kraken2 as input files. This tool will generate a separate plot for each dataset.",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  },
  {
    "objectID": "sessions/amplicon.html#kraken2-vs-mapseq-comparison",
    "href": "sessions/amplicon.html#kraken2-vs-mapseq-comparison",
    "title": "Amplicon practical",
    "section": "Kraken2 vs MAPseq comparison",
    "text": "Kraken2 vs MAPseq comparison\nOpen the two krona plots you just generated. They should look like these two:\n\n\n\n\n\n\nMAPseq\n\n\n\n\n\n\n\nKraken2\n\n\n\n\n\nLook at the difference in annotation numbers.\n\n\n\n\n\n\nQuestion\n\n\n\nNotice the contamination on MAPseq’s output. Thinking about the parameters that we used, do you understand why this was picked up by MAPseq, but not by Kraken2?\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nKraken2 was only focused on a bacterial database, while we used a generic SSU database for MAPseq. Also this shows probably how much contamination there was in the initil sample, underlying how important it is to decontaminate your sample beforehand.\n\n\n\nLet’s focus on the bacterial annotations only.\n\n\n\nMAPseq_bac",
    "crumbs": [
      "Home",
      "Sessions",
      "Amplicon practical"
    ]
  }
]